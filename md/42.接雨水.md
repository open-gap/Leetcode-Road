# æ¥é›¨æ°´ #  
`éš¾åº¦ï¼šå›°éš¾` 
 
ç»™å®š `n` ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º `1` çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚  

![ç¤ºæ„å›¾](../pic/rainwatertrap.png "æ¥é›¨æ°´")  

ä¸Šé¢æ˜¯ç”±æ•°ç»„ `[0,1,0,2,1,0,1,3,2,1,2,1]` è¡¨ç¤ºçš„é«˜åº¦å›¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¥ `6` ä¸ªå•ä½çš„é›¨æ°´ï¼ˆè“è‰²éƒ¨åˆ†è¡¨ç¤ºé›¨æ°´ï¼‰ã€‚Â **æ„Ÿè°¢ Marcos** è´¡çŒ®æ­¤å›¾ã€‚

**ç¤ºä¾‹ï¼š**  
>**è¾“å…¥:** [0,1,0,2,1,0,1,3,2,1,2,1]  
>**è¾“å‡º:** 6  

æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰  
é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/trapping-rain-water/  
è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚  

---  
>è§£æ³•ä¸€ï¼šä¸¤æ­¥æ³•  

åˆ†åˆ«ä»å·¦å¾€å³ğŸ‘‰å’Œä»å³å¾€å·¦ğŸ‘ˆä¸¤ä¸ªæ–¹å‘çœ‹æ•°ç»„ï¼Œå¾—åˆ°ä»¥æ•°ç»„æœ€å¤§å€¼ä¸ºåˆ†ç•Œçš„å·¦å³ä¸¤éƒ¨åˆ†çš„é›¨æ°´é‡ï¼Œå†æ±‚å’Œ  
```C++
class Solution {
public:
    int trap(vector<int>& height) {
        if(height.empty()) return 0;
        else
        {
            int result = 0, temp = 0, maxIndex = 0, tempIndex = 0;
            // ä¸¤æ­¥æ³•ï¼Œå…ˆä»å·¦å¾€å³çœ‹
            for(int i = 1; i < height.size(); ++i)
            {
                if(height[i] >= height[maxIndex])
                {
                    maxIndex = i;
                    result += temp;
                    temp = 0;
                }
                else temp += height[maxIndex] - height[i];
            }
            // ç„¶åä»å³å¾€å·¦çœ‹
            temp = 0;
            tempIndex = height.size() - 1;
            for(int j = tempIndex - 1; j >= maxIndex; --j)
            {
                if(height[j] >= height[tempIndex])
                {
                    tempIndex = j;
                    result += temp;
                    temp = 0;
                }
                else temp += height[tempIndex] - height[j];
            }
            return result;
        }
    }
};
```  

**æ‰§è¡Œç»“æœï¼š**  
æ‰§è¡Œç”¨æ—¶ : **12 ms** , åœ¨æ‰€æœ‰ cpp æäº¤ä¸­å‡»è´¥äº† **42.62%** çš„ç”¨æˆ·  
å†…å­˜æ¶ˆè€— : **9.1 MB** , åœ¨æ‰€æœ‰ cpp æäº¤ä¸­å‡»è´¥äº† **82.38%** çš„ç”¨æˆ·  

---  
>è§£æ³•äºŒï¼šä½¿ç”¨æ ˆçš„æ•°æ®ç»“æ„ï¼Œåœ¨å¾ªç¯ä¸­ä¿æŒæ ˆé¡¶å€¼æœ€å°  

```C++
class Solution {
public:
    int trap(vector<int>& height) {
        int result = 0, temp = 0, tmpMin = 0;
        stack<int> stk;
        for(int i = 0; i < height.size(); ++i)
        {
            if(stk.empty()) stk.push(i);
            else if(height[stk.top()] > height[i]) stk.push(i);
            else
            {
                while(!stk.empty() && height[stk.top()] <= height[i])
                {
                    temp = stk.top();
                    stk.pop();
                    if(stk.empty()) break;
                    else
                    {
                        tmpMin = height[stk.top()] > height[i] ? height[i] : height[stk.top()];
                        result += (tmpMin - height[temp]) * (i - 1 - stk.top());
                    }
                }
                stk.push(i);
            }
        }
        return result;
    }
};
```  

**æ‰§è¡Œç»“æœï¼š**  
æ‰§è¡Œç”¨æ—¶ : **12 ms** , åœ¨æ‰€æœ‰ cpp æäº¤ä¸­å‡»è´¥äº† **42.62%** çš„ç”¨æˆ·  
å†…å­˜æ¶ˆè€— : **9.4 MB** , åœ¨æ‰€æœ‰ cpp æäº¤ä¸­å‡»è´¥äº† **70.38%** çš„ç”¨æˆ·  

---  
>è§£æ³•ä¸‰ï¼šåŒæŒ‡é’ˆæ³•  

åœ¨è§£æ³•ä¸€çš„åŸºç¡€ä¸Šä½¿ç”¨åŒæŒ‡é’ˆé¿å…äº†ä¸¤æ¬¡éå†çš„æ—¶é—´èŠ±è´¹ï¼Œåœ¨ä¸€æ¬¡éå†çš„è¿‡ç¨‹ä¸­æ‰¾åˆ°ç»“æœ  
```C++
class Solution {
public:
    int trap(vector<int>& height) {
        int result = 0, left = 0, right = height.size() - 1, temp, leftMax, rightMax;
        while(left < right)
        {
            temp = 0;
            leftMax = left++;
            while(left <= right && height[left] < height[leftMax]) temp += height[leftMax] - height[left++];
            if(left > right) left = leftMax;
            else result += temp;

            temp = 0;
            rightMax = right--;
            while(right >= left && height[right] < height[rightMax]) temp += height[rightMax] - height[right--];
            if(right < left) right = rightMax;
            else result += temp;
        }
        return result;
    }
};
```  

**æ‰§è¡Œç»“æœï¼š**  
æ‰§è¡Œç”¨æ—¶ : **12 ms** , åœ¨æ‰€æœ‰ cpp æäº¤ä¸­å‡»è´¥äº† **42.62%** çš„ç”¨æˆ·  
å†…å­˜æ¶ˆè€— : **9.1 MB** , åœ¨æ‰€æœ‰ cpp æäº¤ä¸­å‡»è´¥äº† **84.18%** çš„ç”¨æˆ·  

---  
>è§£æ³•å››ï¼šå®˜æ–¹é¢˜è§£ä¸­çš„åŒæŒ‡é’ˆæ³•ï¼Œé€»è¾‘ä¼˜äºè§£æ³•ä¸‰  

```C++
class Solution {
public:
    int trap(vector<int>& height) {
        int result = 0, left = 0, right = height.size() - 1;
        if(height.empty()) return 0;
        else
        {
            int leftMax = height[left], rightMax = height[right];
            while(left < right)
            {
                if(height[left] < height[right])
                {
                    if(leftMax > height[++left]) result += leftMax - height[left];
                    else leftMax = height[left];
                }
                else
                {
                    if(rightMax > height[--right]) result += rightMax - height[right];
                    else rightMax = height[right];
                }
            }
            return result;
        }
    }
};
```  

**æ‰§è¡Œç»“æœï¼š**  
æ‰§è¡Œç”¨æ—¶ : **12 ms** , åœ¨æ‰€æœ‰ cpp æäº¤ä¸­å‡»è´¥äº† **42.62%** çš„ç”¨æˆ·  
å†…å­˜æ¶ˆè€— : **9.1 MB** , åœ¨æ‰€æœ‰ cpp æäº¤ä¸­å‡»è´¥äº† **78.56%** çš„ç”¨æˆ·  

---  